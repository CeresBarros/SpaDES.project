<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Working with LandR-fireSense • SpaDES.project</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Working with LandR-fireSense">
<meta property="og:description" content="SpaDES.project">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-58633549-3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-58633549-3');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SpaDES.project</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/LandR-fireSense.html">Working with LandR-fireSense</a>
    </li>
    <li>
      <a href="../articles/getting-started.html">Installing SpaDES</a>
    </li>
    <li>
      <a href="../articles/managing-large-SpaDES-projects.html">Managing large SpaDES projects</a>
    </li>
    <li>
      <a href="../articles/using-git-github.html">Using git for project development</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/PredictiveEcology/SpaDES.project/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="LandR-fireSense_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Working with LandR-fireSense</h1>
                        <h4 class="author">Alex M. Chubaty and Ian M. S. Eddy</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/PredictiveEcology/SpaDES.project/blob/master/vignettes/LandR-fireSense.Rmd"><code>vignettes/LandR-fireSense.Rmd</code></a></small>
      <div class="hidden name"><code>LandR-fireSense.Rmd</code></div>

    </div>

    
    
<div id="getting-started-with-landr-and-firesense" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-started-with-landr-and-firesense" class="anchor"></a>Getting started with LandR and fireSense</h2>
<p>This guide provides a template project setup for using the LandR forest succession model with the FireSense climate-sensitive fire model. There are several components you, as the project user/developer, will need to develop and customize for your project, which will be noted below.</p>
<p>Please ensure you have reviewed the following, and have completed the prerequisite installations of R, RStudio, <code>SpaDES</code>, GIS software, and <code>git</code>.</p>
<!-- TODO: ensure these are linked correctly -->
<ol style="list-style-type: decimal">
<li><a href="getting-started">R/SpaDES installation</a></li>
<li><a href="managing-large-SpaDES-projects">Managing large SpaDES projects</a></li>
<li><a href="using-git-github">Using git and GitHub</a></li>
</ol>
</div>
<div id="create-new-project" class="section level2">
<h2 class="hasAnchor">
<a href="#create-new-project" class="anchor"></a>Create new project</h2>
<ol style="list-style-type: decimal">
<li><p>Start by creating a new git repository on GitHub (see <a href="https://docs.github.com/en/github/getting-started-with-github/create-a-repo" class="uri">https://docs.github.com/en/github/getting-started-with-github/create-a-repo</a>) which will host your project.</p></li>
<li>
<p>Clone your new repo to your local machine:</p>
<pre><code>git clone https://github.com/USERNAME/MYREPO /path/to/my/projects/myNewProject</code></pre>
</li>
<li>
<p>Create a new SpaDES project at this location:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://spades-project.predictiveecology.org/">"SpaDES.project"</a></span><span class="op">)</span>

<span class="fu"><a href="../reference/newProject.html">newProject</a></span><span class="op">(</span><span class="st">"myNewProject"</span>, <span class="st">"path/to/my/projects"</span>, type <span class="op">=</span> <span class="st">"LandR-fireSense"</span>, open <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
</li>
<li><p>Open your project in Rstudio (see <a href="https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects" class="uri">https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects</a>).</p></li>
</ol>
</div>
<div id="ensure-packages-installed-to-project-library" class="section level2">
<h2 class="hasAnchor">
<a href="#ensure-packages-installed-to-project-library" class="anchor"></a>Ensure packages installed to project library</h2>
<p>It’s best to use a standalone package library, and we highly recommend using one here.</p>
<p>Check that the project’s <code>packages/</code> subdirectory is being used:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/libPaths.html">.libPaths</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Ensure some key packages are installed (remaining packages used by modules will be installed on first run).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"Require"</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://Require.predictiveecology.org">Require</a></span><span class="op">)</span>
<span class="fu"><a href="https://Require.predictiveecology.org/reference/Require.html">Require</a></span><span class="op">(</span><span class="st">"PredictiveEcology/climateData"</span><span class="op">)</span></code></pre></div>
</div>
<div id="add-landr-and-firesense-modules" class="section level2">
<h2 class="hasAnchor">
<a href="#add-landr-and-firesense-modules" class="anchor"></a>Add LandR and fireSense modules</h2>
<p>We strongly recommend using git for version control, and using git submodules to manage individual project modules.</p>
<pre><code>cd /path/to/my/projects/myNewProject

## add LandR modules
git submodule add https://github.com/PredictiveEcology/Biomass_borealDataPrep modules/Biomass_borealDataPrep
git submodule add https://github.com/PredictiveEcology/Biomass_core modules/Biomass_core
git submodule add https://github.com/PredictiveEcology/Biomass_regeneration modules/Biomass_regeneration
git submodule add https://github.com/PredictiveEcology/Biomass_speciesData modules/Biomass_speciesData

## add fireSense modules
git submodule add https://github.com/PredictiveEcology/fireSense modules/fireSense
git submodule add https://github.com/PredictiveEcology/fireSense_dataPrepFit modules/fireSense_dataPrepFit
git submodule add https://github.com/PredictiveEcology/fireSense_dataPrepPredict modules/fireSense_dataPrepPredict
git submodule add https://github.com/PredictiveEcology/fireSense_IgnitionFit modules/fireSense_IgnitionFit
git submodule add https://github.com/PredictiveEcology/fireSense_IgnitionPredict modules/fireSense_IgnitionPredict
git submodule add https://github.com/PredictiveEcology/fireSense_EscapeFit modules/fireSense_EscapeFit
git submodule add https://github.com/PredictiveEcology/fireSense_EscapePredict modules/fireSense_EscapePredict
git submodule add https://github.com/PredictiveEcology/fireSense_SpreadFit modules/fireSense_SpreadFit
git submodule add https://github.com/PredictiveEcology/fireSense_SpreadPredict modules/fireSense_SpreadPredict</code></pre>
<p>Optionally, you can add branch info for each of the submodules by editing the <code>.gitmodules</code> file and running <code>git submodule sync</code>.</p>
<p><em>NOTE:</em> Alternatively, each of these modules can be fetched using <code>SpaDES.install::getModule()</code>, which will download the latest versions. However, this approach makes it harder to update modules in the future.</p>
</div>
<div id="create-data-prep-module-for-your-study-area" class="section level1">
<h1 class="hasAnchor">
<a href="#create-data-prep-module-for-your-study-area" class="anchor"></a>Create data prep module for your study area</h1>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">newModule</span><span class="op">(</span><span class="st">"myStudyArea_dataPrep"</span>, path <span class="op">=</span> <span class="st">"modules"</span><span class="op">)</span></code></pre></div>
<p>At a minimum, this module needs to create the following objects to be passed to the LandR and fireSense data prep modules:</p>
<pre><code>  outputObjects = bindrows(
    createsOutput("historicalClimateRasters", objectClass = "list",
                  desc = "list of a single raster stack - historical MDC calculated from ClimateNA data"),
    createsOutput("projectedClimateRasters", objectClass = "list",
                  desc = "list of a single raster stack - projected MDC calculated from ClimateNA data"),
    createsOutput("rasterToMatch", objectClass = "RasterLayer",
                  desc = "template raster"),
    createsOutput("rasterToMatchLarge", objectClass = "RasterLayer",
                  desc = "template raster for larger area"),
    createsOutput("rasterToMatchReporting", objectClass = "RasterLayer",
                  desc = "template raster for reporting area"),
    createsOutput("sppColorVect", objectClass = "character",
                  desc = "species colours for plotting"),
    createsOutput("sppEquiv", objectClass = "character",
                  desc = "table of LandR species names equivalencies"),
    createsOutput("sppEquivCol", objectClass = "character",
                  desc = "name of column to use in sppEquiv"),
    createsOutput("standAgeMap2011", objectClass = "RasterLayer",
                  desc = "time since disturbance raster for year 2011"),
    createsOutput("studyArea", objectClass = "SpatialPolygonsDataFrame",
                  desc = "study area used for simulation (buffered to mitigate edge effects)"),
    createsOutput("studyAreaLarge", objectClass = "SpatialPolygonsDataFrame",
                  desc = "study area used for module parameterization (buffered)"),
    createsOutput("studyAreaReporting", objectClass = "SpatialPolygonsDataFrame",
                  desc = "study area used for reporting/post-processing")
  )</code></pre>
<p>For a concrete example of a study area module used for the Western Boreal Initiative (WBI), see <a href="https://github.com/PredictiveEcology/WBI_dataPrep_studyArea/" class="uri">https://github.com/PredictiveEcology/WBI_dataPrep_studyArea/</a>.</p>
</div>
<div id="climate-data-preparation" class="section level1">
<h1 class="hasAnchor">
<a href="#climate-data-preparation" class="anchor"></a>Climate data preparation</h1>
<p>We have used ClimateNA (<a href="http://climatena.ca/" class="uri">http://climatena.ca/</a>) to downscale monthly climate data to get historic and future projected monthly drought code (MDC) rasters for our study areas. Unfortunately, ClimateNA does not currently have a scriptable programming interface, and these climate layers must be assembled manually using the ClimateNA point-and-click graphical tool.</p>
<ol style="list-style-type: decimal">
<li>
<p>Download and install the ClimateNA software (Windows only).</p>
<ol style="list-style-type: lower-alpha">
<li><p>Go to <a href="http://climatebc.ca/downloads/download.html" class="uri">http://climatebc.ca/downloads/download.html</a> and register your email. You will receive a confirmation email containing a link to download the latest version.</p></li>
<li><p>Download and extract the zip file from the link in the email. This extracts the standalone program and its files; it does not ‘install’ the program in the traditional sense.</p></li>
<li>
<p>Windows security restrictions may prevent you from running the program. Right click the executable file and go to ‘Properties’. Check the ‘Unblock’ box under the ‘Security’ heading, and ‘Apply’ the settings.</p>
<p><img src="images/ClimateNA-unblock.png"></p>
</li>
</ol>
</li>
<li>
<p>Download a suitable digital elevation model (DEM) that covers your study area. We have used the <a href="https://www.usgs.gov/centers/eros/science/usgs-eros-archive-digital-elevation-global-30-arc-second-elevation-gtopo30?qt-science_center_objects=0#qt-science_center_objects">USGS GTOPO30 product</a> to produce 1 or 3 arc minute DEMs.</p>
<ol style="list-style-type: lower-alpha">
<li>Use <code><a href="https://rdrr.io/pkg/climateData/man/makeClimateDEM.html">climateData::makeClimateDEM()</a></code> to prepare the DEM for your study area.</li>
</ol>
</li>
<li>
<p>Use ClimateNA to fetch monthly historic (1991-2019) and projected data.</p>
<ol style="list-style-type: lower-alpha">
<li>
<p>The interface is split into two parts: “Single Location” and “Multi-location” panes. We will be using the multi-location panes, so ignore the settings in the single location panes.</p>
<p><img src="images/ClimateNA-UI.png"></p>
</li>
<li><p>In the first dropdown in the multi-location pane, select ‘Historical Time Series’.</p></li>
<li><p>In the second dropdown, select ‘Monthly variables’. You will be prompted to supply start and end years (for fireSense we are using 1991-2019). <em>NOTE:</em> historical data will take a long time to fetch and process, but the process can be resumed from which ever year was in progress when the download was interrupted.</p></li>
<li><p>Next, click the ‘Select input file’ button and find the <code>.asc</code> DEM raster file for your study area. Make sure you select ‘asc’ in the file selection pane.</p></li>
<li><p>Next, click on the ‘Select output file’ box to choose a save location for the processed data files. <em>NOTE:</em> the resulting data files might use several gigabytes to hundreds of gigabytes in disk space, depending on the date range and geographic extent of your study area.</p></li>
<li><p>Click ‘Start TS’ to begin. It may take several days depending on the date range and geographic extent of your study area.</p></li>
<li><p>Repeat the steps above for ‘Future Time Series’. You will be asked to select a climate model from the dropdown list (for fireSense we are using CCSM4 RCP 4.5 and 8.5).</p></li>
<li><p>(Optional) After downloading all the climate data, you may wish to upload to a cloud-accessible location (e.g., Google Drive) to make it easy for collaborators to access the raw files if needed.</p></li>
</ol>
</li>
<li>
<p>Create raster maps of MDC for use with fireSense:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Use <code><a href="https://rdrr.io/pkg/climateData/man/makeMDC.html">climateData::makeMDC()</a></code> to create the MDC rasters.</p></li>
<li><p>Upload these to Google Drive (make note of the Google file ids) for use with <code>prepInputs()</code> in your study area data prep module.</p></li>
</ol>
</li>
</ol>
</div>
<div id="project-script-configuration" class="section level1">
<h1 class="hasAnchor">
<a href="#project-script-configuration" class="anchor"></a>Project script configuration</h1>
<ol start="0" style="list-style-type: decimal">
<li><p>The main project script is <code>00-global.R</code>. All subsequent scripts are <code>source</code>d from this file.</p></li>
<li><p>Set user (or machine) specific options in <code>config.yml</code>, such as cache path, cache type, Google account info, etc.</p></li>
<li><p>Additional user options can be added to the config file, just remember to assign these values in <code>01-init.R</code>, even if they aren’t used until later scripts.</p></li>
<li><p>Simulation paths (e.g., those used by modules) are defined in <code>02-paths.R</code>. Use relative paths only. Different cache paths may be specified for finer control.</p></li>
<li><p>Any additional packages used can be specified in <code>03-packages.R</code>.</p></li>
<li><p>Package options are set in <code>04-options.R</code>. User-specific options should not be defined here (set these in <code>config.yml</code>).</p></li>
<li><p>The Google Drive file ids defined in <code>05-google-ids.R</code> will be blank to start with. As you run the subsequent scripts and upload simulation results, you can add the Google file ids to the list defined here. This allows future runs to skip long-running or intensive computations, such as those required to run <code>fireSense_SpreadFit</code>, and download a pre-computed result.</p></li>
<li><p>You run your study area data prep module by invoking this script. This script may require additional updating/editing (e.g., the name of the module you created).</p></li>
<li><p>Subsequent scripts (07a, 07b, 07c, 08a, 08b, and 08c) shouldn’t need much tweaking by the user.</p></li>
<li><p>The main dynamic simulation is run by <code>09-main-sim.R</code>.</p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Alex M Chubaty.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
